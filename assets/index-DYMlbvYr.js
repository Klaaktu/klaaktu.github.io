(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const F of a.addedNodes)F.tagName==="LINK"&&F.rel==="modulepreload"&&s(F)}).observe(document,{childList:!0,subtree:!0});function n(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(c){if(c.ep)return;c.ep=!0;const a=n(c);fetch(c.href,a)}})();window.onload=function(){const e=document.querySelector(".hamburger"),t=document.querySelector(".mobile-nav"),n=document.getElementById("panning"),s=document.getElementById("polygon-draw");if(document.querySelector(".expand-button"),e.addEventListener("click",function(){e.classList.toggle("is-active"),t.classList.toggle("is-active")}),n.addEventListener("click",()=>{mode=Mode.DRAG}),s.addEventListener("click",()=>{mode=Mode.ADD}),typeof polygons<"u"){const c=document.getElementById("shape-list");c&&(c.innerHTML="",Z())}};function Z(){const e=document.getElementById("shape-list");e.innerHTML="",polygons.forEach((t,n)=>{const s=document.createElement("div");s.className="shape-container",s.style.border="1px solid #444",s.style.marginBottom="12px",s.style.padding="8px",s.style.background=t.select?"#333":"#272a2e";const c=document.createElement("div");c.textContent=`Shape ${n+1}`,c.style.fontWeight="bold",c.style.color="#fff",s.appendChild(c);const a=document.createElement("ul");a.style.paddingLeft="16px",a.style.color="#ccc",t.vertices.forEach((T,A)=>{const W=document.createElement("li");W.style.display="flex";const $=document.createElement("input");$.id=`vertex-input-${A}`,$.addEventListener("keydown",te=>{te.key==="Enter"&&be(te,A,t)}),W.textContent=`Vertex ${A+1}: `,$.value=`(${T[0].toFixed(1)}, ${T[1].toFixed(1)})`,a.appendChild(W),a.appendChild($);const V=document.createElement("button");V.textContent="Remove",V.style.marginLeft="8px",V.onclick=()=>{t.vertices=t.vertices.filter((te,Fe)=>Fe!==A),Z(),draw()},a.appendChild(V),e.appendChild(s)}),s.appendChild(a);const F=document.createElement("button");F.textContent="Add",F.onclick=()=>{const T=t.vertices[t.vertices.length-1],A=t.vertices[0];midx=(T[0]+A[0])/2,midy=(T[1]+A[1])/2;const W=[midx,midy-10];t.vertices.push(W),Z(),draw()},s.appendChild(F);const U=document.createElement("button");U.textContent="Delete",U.style.marginLeft="8px",U.onclick=()=>{polygons=polygons.filter(T=>T!==polygons[n]),Z(),draw()},s.appendChild(U),e.appendChild(s)})}function be(e,t,n){const c=e.target.value.trim().match(/^\s*\(?\s*(-?\d*\.?\d+)\s*,\s*(-?\d*\.?\d+)\s*\)?\s*$/);if(c){const a=parseFloat(c[1]),F=parseFloat(c[2]);n.vertices[t]=[a,F],draw()}}const f=document.getElementById("canvas"),o=f.getContext("2d"),J=["#FF5733","#33FF57","#3357FF","#FF33A1","#FFBD33","#33FFBD","#BD33FF","#8DFF33","#33A1FF","#A133FF","#FF5733","#33FFBD","#8D33FF","#FF338D","#33FF8D","#8DFF33","#FF8D33","#33BDFF","#BDFF33","#FF33BD"],de=1024,ae=8e-4,Oe=1.1,Me=.9,ue="#333",Y="#333",X="#D3D3D3",j="#333",q="#333",Te=5,O=Object.freeze({DRAG:"DRAG",ADD:"ADD",DELETE:"DELETE"});navbarHeight=document.getElementById("navbar").offsetHeight;let ne=2,L=O.DRAG,Ae=[[200,100],[200,500],[500,500],[500,100]],Ce=[[100,300],[600,400],[600,200]],u=[{select:!0,vertices:Ae,colour:J[0]},{select:!0,vertices:Ce,colour:J[1]}],M=null,P=null,G=null,me=null,Q=null,r=null,S=[0,0],H=[0,f.height],I=null,h=1,E,D,k,oe,_,N,z,w,b,C,ee,R;function pe(){oe=Le(f.width/h/9),_=f.width/h/500,N=_*.75,z=_*.5,w=f.width/h/150,b=w/1.8,C=w*2,ee=_*1.5,R=w*1.5}function ve(){E=ce([0,0]),D=ce([window.innerWidth,window.innerHeight-navbarHeight]),k=[E[0]-f.width/h,E[1]+f.height/h],drawBottomRight=[k[0]+3*(f.width/h),k[1]-3*(f.height/h)]}pe();ve();function B(){ve(),o.clearRect(...k,drawBottomRight[0]-k[0],drawBottomRight[1]-k[1]),o.setTransform(1,0,0,1,0,0),o.translate(...H),pe(),o.scale(h,-h),Re(),Be(),_e(),Pe(),renderShapeList()}function Re(){let e=Math.max(...E.concat(D).map(Math.abs));for(i=0;i<=e;i+=oe/5)g([i,D[1]],[i,E[1]],z,X),g([-i,D[1]],[-i,E[1]],z,X),g([D[0],i],[E[0],i],z,X),g([D[0],-i],[E[0],-i],z,X);for(g([0,D[1]],[0,E[1]],_,ue),g([D[0],0],[E[0],0],_,ue),i=0;i<=e;i+=oe)g([i,D[1]],[i,E[1]],N,Y),g([-i,D[1]],[-i,E[1]],N,Y),g([D[0],i],[E[0],i],N,Y),g([D[0],-i],[E[0],-i],N,Y),g([i,0],[i,w],b,j),i!==0&&(g([-i,0],[-i,w],b,j),g([0,i],[w,i],b,j),g([0,-i],[w,-i],b,j)),label=String(i%1===0?i:i.toFixed(3)),K([i+b/4,w+C/4],label,C,q),i!==0&&(K([-i+b/4,w+C/4],"-"+label,C,q),K([w+w/4,i+b/4],label,C,q),K([w+w/4,-i+b/4],"-"+label,C,q))}function g(e,t,n,s){o.beginPath(),o.moveTo(...e),o.lineTo(...t),o.closePath(),o.strokeStyle=s,o.lineWidth=n,o.stroke()}function K(e,t,n,s){o.save(),o.scale(1,-1),o.font=n+"px Arial bold",o.fillStyle=s,o.fillText(t,e[0],-e[1]),o.restore()}function Be(){u.forEach((e,t)=>{e.select&&ye(e.vertices,e.colour)}),u.forEach(e=>Se(e.vertices)),u.forEach(e=>le(e.vertices))}function ye(e,t){o.beginPath(),o.moveTo(e[0][0],e[0][1]),e.forEach(n=>{o.lineTo(n[0],n[1])}),o.closePath(),o.fillStyle=t,o.fill()}function Se(e){o.beginPath(),o.moveTo(e[0][0],e[0][1]),e.forEach(t=>{o.lineTo(t[0],t[1])}),o.closePath(),o.strokeStyle="#333",o.lineWidth=ee,o.stroke()}function le(e,t="#333"){o.fillStyle=t,e.forEach(n=>{o.fillRect(n[0]-R/2,n[1]-R/2,R,R)})}function _e(){inter=intersection(u.filter(e=>e.select).map(e=>e.vertices)),inter!==null&&inter.length>=1&&ye(inter,"#333")}function Pe(){if(r!==null){for(o.beginPath(),o.moveTo(r[0][0],r[0][1]),i=1;i<r.length;i++)o.lineTo(r[i][0],r[i][1]);o.strokeStyle="#333",o.lineWidth=ee,o.stroke(),p=[...r,S];let e=r.length<=2||isConvex([r[r.length-1],S,r[0],r[1]])?"#333":"red";o.beginPath(),o.moveTo(...r[r.length-1]),o.lineTo(...S),o.lineTo(...r[0]),o.strokeStyle=e,o.lineWidth=ee,o.stroke(),le(r),le([S],e=e)}}window.addEventListener("resize",Ee);f.addEventListener("contextmenu",Ie);f.addEventListener("wheel",ke);f.addEventListener("mousedown",We);f.addEventListener("mousemove",Ne);f.addEventListener("mouseup",we);f.addEventListener("mouseleave",we);function Ee(){f.width=window.innerWidth,f.height=window.innerHeight-navbarHeight,B()}function Ie(e){e.preventDefault(),L===O.ADD&&xe(),B()}function ke(e){e.preventDefault(),e.deltaY<0?fe(Oe):fe(Me),B()}function We(e){let t=se(e);G=t,me=L,Q=[e.clientX,e.clientY],L===O.DRAG?(M=Ue(t),M===null&&(P=He(t),P===null&&(I=H))):L===O.ADD&&ze(t),B()}function Ne(e){let t=se(e);if(L===O.DRAG)if(M!==null){v=u[M[0]].vertices,i=M[1],l=v.length;let n=!1;(l<=3||l===4&&isConvex(v)||isConvex([v[i-2<0?l-i-2:i-2],v[i-1===-1?l-1:i-1],t,v[(i+1)%l],v[(i+2)%l]]))&&(n=!0),n&&(u[M[0]].vertices[M[1]]=t)}else P!==null?u[P[0]].vertices=P[1].map(n=>[t[0]+n[0],t[1]+n[1]]):I!==null&&(H=[I[0]+e.clientX-Q[0],I[1]+e.clientY-Q[1]]);else L===O.ADD&&(S=t);B()}function we(e){let t=se(e);Q=null,L===O.DRAG?(M=null,P=null,I!==null&&(I=null),he(t)&&(i=re(t),i!==null&&(u[i].select=!u[i].select),G=null)):L===O.DELETE&&he(t)&&(i=re(t),i!==null&&(u=u.filter(n=>n!==u[i])),G=null,renderShapeList()),B()}function ze(e){r===null?r=[e]:De(e,r[0])?(Ge(r),xe()):(r.length<=2||isConvex([r[r.length-1],S,r[0],r[1]]))&&r.push(e)}function xe(){r!==null&&(r=null,L=O.DRAG)}function Ge(e){u.push({select:!0,vertices:e,colour:J[ne]}),ne=ne+1%J.length}function fe(e){h*=e,h>de?h=de:h<ae&&(h=ae)}function He(e){if(i=re(e),i===null)return null;let t=u[i].vertices.map(n=>[n[0]-e[0],n[1]-e[1]]);return[i,t]}function re(e){let t=null;for(let n=0;n<u.length;n++)point_in_polygon(u[n].vertices,e)&&(t=n);return t}function Ue(e){let t;for(let n=0;n<u.length;n++)for(let s=0;s<u[n].vertices.length;s++)if(t=u[n].vertices[s],De(e,t))return[n,s];return null}function De(e,t){return Math.abs(e[0]-t[0])<R&&Math.abs(e[1]-t[1])<R}function se(e){const t=f.getBoundingClientRect();return ce([e.clientX-t.left,e.clientY-t.top])}function he(e){return G!==null&&me===L&&$e(e,G)<=Te}function ce(e){return[x,y]=e,[(x-H[0])/h,-(y-H[1])/h]}function $e(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])}function Le(e){return e<1?(d=String(Math.abs(.004)).replace(/0\.0+/,"").length,Le(e*Math.pow(10,d))/Math.pow(10,d)):(m=Math.pow(10,String(Math.abs(Math.trunc(e))).length-1),Math.round(e/m)*m)}Ee();B();let Ve;const Ye=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Ye.decode();const ie=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}};ie.encodeInto;const ge=Object.freeze({JSON:0,0:"JSON",YAML:1,1:"YAML"});typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>Ve.__wbg_instance_free(e>>>0,1));ge.JSON+"",ge.YAML+"";
